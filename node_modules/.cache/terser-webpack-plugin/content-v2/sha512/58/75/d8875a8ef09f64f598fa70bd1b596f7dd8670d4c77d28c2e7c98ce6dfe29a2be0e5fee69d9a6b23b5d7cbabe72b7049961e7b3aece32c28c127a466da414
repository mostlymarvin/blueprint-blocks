{"code":"!function(e){var t={};function s(n){if(t[n])return t[n].exports;var l=t[n]={i:n,l:!1,exports:{}};return e[n].call(l.exports,l,l.exports,s),l.l=!0,l.exports}s.m=e,s.c=t,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&\"object\"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,\"default\",{enumerable:!0,value:e}),2&t&&\"string\"!=typeof e)for(var l in e)s.d(n,l,function(t){return e[t]}.bind(null,l));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,\"a\",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p=\"\",s(s.s=0)}([function(e,t,s){\"use strict\";s.r(t);s(1),s(3);function n(e){return(n=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&\"function\"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":typeof e})(e)}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function r(e){if(void 0===e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return e}function a(e,t){for(var s=0;s<t.length;s++){var n=t[s];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,t,s){return t&&a(e.prototype,t),s&&a(e,s),e}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var p=wp.i18n.__,u=wp.blocks.registerBlockType,c=wp.components.SelectControl,b=wp.element.Component,m=wp.editor.RichText,d=function(e){function t(){var e,s,a;return function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,t),s=this,(e=!(a=l(t).apply(this,arguments))||\"object\"!==n(a)&&\"function\"!=typeof a?r(s):a).state=e.constructor.getInitialState(e.props.attributes.selectedPost),e.getOptions=e.getOptions.bind(r(e)),e.getOptions(),e.onChangeSelectPost=e.onChangeSelectPost.bind(r(e)),e.onChangeTitlePrefix=e.onChangeTitlePrefix.bind(r(e)),e.onChangeButtonsLabel=e.onChangeButtonsLabel.bind(r(e)),e.getBookMedia=e.getBookMedia.bind(r(e)),e}return function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function\");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(t,b),o(t,null,[{key:\"getInitialState\",value:function(e){return{posts:[],selectedPost:e,post:{}}}}]),o(t,[{key:\"onChangeSelectPost\",value:function(e){var t=this.state.posts.find(function(t){return t.id==parseInt(e)});this.setState({selectedPost:parseInt(e),post:t});var s=t.mbt_book_teaser[0],n=t.excerpt.rendered,l=t.mbt_sample_audio[0],r=t.mbt_unique_id_asin[0],a=t.mbt_book_image_id[0];this.getBookMedia(a);var o=t.mbt_buybuttons[0];this.props.setAttributes({selectedPost:parseInt(e),title:t.title.rendered,link:t.link,buylinks:o,tagline:s,blurb:n,audioSample:l,bookSample:r})}},{key:\"getBookMedia\",value:function(e){var t=this;new wp.media.model.Attachment.get(e).fetch().then(function(e){t.props.setAttributes({cover:e.url})})}},{key:\"onChangeTitlePrefix\",value:function(e){this.props.setAttributes({titlePrefix:e})}},{key:\"onChangeButtonsLabel\",value:function(e){this.props.setAttributes({buttonsLabel:e})}},{key:\"getOptions\",value:function(){var e=this;wp.api.models.Post.extend({urlRoot:wpApiSettings.root+\"wp/v2/mbt_book\",defaults:{type:\"mbt_book\"}});(new(wp.api.collections.Posts.extend({url:wpApiSettings.root+\"wp/v2/mbt_book\"}))).fetch().then(function(t){if(t&&0!==e.state.selectedPost){var s=t.find(function(t){return t.id==e.state.selectedPost});e.setState({post:s,posts:t})}else e.setState({posts:t})})}},{key:\"render\",value:function(){var e=[{value:0,label:p(\"Select a Post\")}];p(\"Choose Book\");return this.props.className+=\" loading\",this.state.posts.length>0?this.state.posts.forEach(function(t){e.push({value:t.id,label:t.title.rendered})}):p(\"No posts found. Please create some first.\"),void 0!==this.state.post&&this.state.post.hasOwnProperty(\"title\")?(wp.element.createElement(\"div\",{className:\"post\"},wp.element.createElement(\"a\",{href:this.state.post.link},this.state.post.title.rendered)),this.props.className+=\" has-post\"):this.props.className+=\" no-post\",wp.element.createElement(\"div\",{className:this.props.className},wp.element.createElement(c,{onChange:this.onChangeSelectPost,value:this.props.attributes.selectedPost,label:p(\"Select a Book\"),options:e,className:\"book-select\"}),wp.element.createElement(\"div\",{className:\"block-preview \"},wp.element.createElement(\"h2\",{className:\"preview-title is-flex\"},this.props.attributes.title&&wp.element.createElement(\"label\",{className:\"components-base-control__label block-label\"},\"Title Prefix:    \"),this.props.attributes.title&&wp.element.createElement(m,{tagName:\"h4\",placeholder:\"Coming Soon, etc.\",className:\"title-prefix\",value:this.props.attributes.titlePrefix,onChange:this.onChangeTitlePrefix,keepPlaceholderOnFocus:!0}),wp.element.createElement(\"span\",{className:\"title\"},this.props.attributes.title)),wp.element.createElement(\"div\",{class:\"inner-preview is-flex\"},wp.element.createElement(\"div\",{className:\"preview-left\"},this.props.attributes.cover&&wp.element.createElement(\"img\",{src:this.props.attributes.cover,className:\"preview-cover\"}),wp.element.createElement(\"div\",{className:\"cover-links\"},this.props.attributes.bookSample&&wp.element.createElement(\"span\",null,\"View Book Sample\"),this.props.attributes.bookSample&&this.props.attributes.audioSample&&wp.element.createElement(\"span\",{className:\"divider\"},\" | \"),this.props.attributes.audioSample&&wp.element.createElement(\"span\",null,\"Hear Audiobook Sample\"))),wp.element.createElement(\"div\",{className:\"preview-right\"},this.props.attributes.tagline&&wp.element.createElement(\"div\",{class:\"preview-tagline\"},this.props.attributes.tagline),this.props.attributes.blurb&&wp.element.createElement(\"div\",{class:\"preview-blurb\"},wp.element.createElement(\"span\",{className:\"blurb-text\",dangerouslySetInnerHTML:{__html:this.props.attributes.blurb}}),wp.element.createElement(\"span\",{className:\"blurb-link\"},wp.element.createElement(\"a\",{className:\"button button-primary\",href:this.props.attributes.link},\"Read More\"))),this.props.attributes.buylinks&&this.props.attributes.buttonsLabel&&wp.element.createElement(m,{tagName:\"h4\",placeholder:\"Now Available From\",className:\"buttons-label\",value:this.props.attributes.buttonsLabel,onChange:this.onChangeButtonsLabel,keepPlaceholderOnFocus:!0}),this.props.attributes.buylinks&&wp.element.createElement(\"div\",{className:\"buylinks\"},wp.element.createElement(\"ul\",null,this.props.attributes.buylinks.map(function(e,t){return wp.element.createElement(\"li\",{className:e.store},wp.element.createElement(\"a\",{href:e.url},e.store))})))))))}}]),t}();u(\"blueprint-blocks/mbt-book\",{title:p(\"MBT Book Custom Display\"),icon:\"book\",category:\"common\",keywords:[p(\"blueprint-blocks — mbt-book\"),p(\"Book\")],attributes:{title:{type:\"string\"},link:{type:\"string\",selector:\"a\"},selectedPost:{type:\"number\",default:null},buylinks:{type:\"array\"},cover:{type:\"string\"},tagline:{type:\"string\"},blurb:{type:\"string\"},audioSample:{type:\"string\",default:\"\"},bookSample:{type:\"string\",default:\"\"},titlePrefix:{type:\"string\",source:\"html\",selector:\".title-prefix\"},buttonsLabel:{type:\"string\",source:\"html\",selector:\".buttons-label\",default:\"Now Available From\"},customLabel:{type:\"boolean\",selector:\".custom-label\"}},edit:d,save:function(e){return wp.element.createElement(\"div\",{className:e.className},wp.element.createElement(\"div\",{className:\"inner is-flex\"},wp.element.createElement(\"div\",{className:\"preview-left\"},e.attributes.cover&&wp.element.createElement(\"a\",{href:e.attributes.link,className:\"image-link\"},wp.element.createElement(\"img\",{src:e.attributes.cover,className:\"preview-cover\",alt:e.attributes.title})),wp.element.createElement(\"div\",{className:\"cover-links\"},e.attributes.bookSample&&wp.element.createElement(\"a\",{className:\"preview-link book-sample\",href:\"https://read.amazon.com/kp/embed?asin=\"+e.attributes.bookSample+\"&preview=newtab\"},\"View Book Sample\"),e.attributes.bookSample&&e.attributes.audioSample&&wp.element.createElement(\"span\",{className:\"divider\"},\" | \"),e.attributes.audioSample&&wp.element.createElement(\"a\",{className:\"preview-link audio-sample\",href:e.attributes.audioSample,target:\"_blank\",rel:\"noopener noreferrer\"},\"Hear Audiobook Sample\"))),wp.element.createElement(\"div\",{className:\"preview-right\"},wp.element.createElement(\"h2\",{className:\"preview-title\"},e.attributes.titlePrefix&&wp.element.createElement(m.Content,{tagName:\"span\",className:\"title-prefix\",value:e.attributes.titlePrefix}),e.attributes.title),e.attributes.tagline&&wp.element.createElement(\"div\",{class:\"preview-tagline\"},e.attributes.tagline),e.attributes.blurb&&wp.element.createElement(\"div\",{class:\"preview-blurb\"},wp.element.createElement(\"span\",{className:\"blurb-text\",dangerouslySetInnerHTML:{__html:e.attributes.blurb}}),wp.element.createElement(\"span\",{className:\"blurb-link\"},wp.element.createElement(\"a\",{className:\"button button-primary button-inline\",href:e.attributes.link},\"Read More\"))),e.attributes.buylinks&&e.attributes.buttonsLabel&&wp.element.createElement(m.Content,{tagName:\"h6\",className:\"buttons-label\",value:e.attributes.buttonsLabel}),e.attributes.buylinks&&wp.element.createElement(\"div\",{className:\"buylinks\"},wp.element.createElement(\"ul\",null,e.attributes.buylinks.map(function(e,t){return wp.element.createElement(\"li\",{className:e.store},wp.element.createElement(\"a\",{href:e.url},e.store))}))))))}})},function(e,t){throw new Error('Module build failed (from ./node_modules/extract-text-webpack-plugin/dist/loader.js):\\nModuleBuildError: Module build failed (from ./node_modules/sass-loader/dist/cjs.js):\\n\\n}\\n^\\n      Invalid CSS after \"}\": expected \"}\", was \"\"\\n      in /Users/lairdsapir/Dropbox/sites/wp/*assets/plugins/blueprint-blocks/blocks/src/mbt-book/style.scss (line 58, column 2)\\n    at /Users/lairdsapir/Dropbox/sites/wp/*assets/plugins/blueprint-blocks/node_modules/webpack/lib/NormalModule.js:313:20\\n    at /Users/lairdsapir/Dropbox/sites/wp/*assets/plugins/blueprint-blocks/node_modules/loader-runner/lib/LoaderRunner.js:367:11\\n    at /Users/lairdsapir/Dropbox/sites/wp/*assets/plugins/blueprint-blocks/node_modules/loader-runner/lib/LoaderRunner.js:233:18\\n    at context.callback (/Users/lairdsapir/Dropbox/sites/wp/*assets/plugins/blueprint-blocks/node_modules/loader-runner/lib/LoaderRunner.js:111:13)\\n    at Object.callback (/Users/lairdsapir/Dropbox/sites/wp/*assets/plugins/blueprint-blocks/node_modules/sass-loader/dist/index.js:89:7)\\n    at Object.done [as callback] (/Users/lairdsapir/Dropbox/sites/wp/*assets/plugins/blueprint-blocks/node_modules/neo-async/async.js:8067:18)\\n    at options.error (/Users/lairdsapir/Dropbox/sites/wp/*assets/plugins/blueprint-blocks/node_modules/node-sass/lib/index.js:294:32)')},,function(e,t){}]);","extractedComments":[]}