{"code":"!function(e){var t={};function n(l){if(t[l])return t[l].exports;var a=t[l]={i:l,l:!1,exports:{}};return e[l].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=t,n.d=function(e,t,l){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:l})},n.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&\"object\"==typeof e&&e&&e.__esModule)return e;var l=Object.create(null);if(n.r(l),Object.defineProperty(l,\"default\",{enumerable:!0,value:e}),2&t&&\"string\"!=typeof e)for(var a in e)n.d(l,a,function(t){return e[t]}.bind(null,a));return l},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,\"a\",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p=\"\",n(n.s=0)}([function(e,t,n){\"use strict\";n.r(t);n(1),n(3);function l(e){return(l=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&\"function\"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":typeof e})(e)}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function r(e){if(void 0===e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return e}function s(e,t){for(var n=0;n<t.length;n++){var l=t[n];l.enumerable=l.enumerable||!1,l.configurable=!0,\"value\"in l&&(l.writable=!0),Object.defineProperty(e,l.key,l)}}function o(e,t,n){return t&&s(e.prototype,t),n&&s(e,n),e}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var p=wp.i18n.__,u=wp.blocks.registerBlockType,c=wp.components.SelectControl,m=wp.element.Component,b=wp.editor,f=b.RichText,d=(b.AlignmentToolbar,b.BlockControls,function(e){function t(){var e,n,s;return function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,t),n=this,(e=!(s=a(t).apply(this,arguments))||\"object\"!==l(s)&&\"function\"!=typeof s?r(n):s).state=e.constructor.getInitialState(e.props.attributes.selectedPost),e.getOptions=e.getOptions.bind(r(e)),e.getOptions(),e.onChangeSelectPost=e.onChangeSelectPost.bind(r(e)),e.onChangeTitlePrefix=e.onChangeTitlePrefix.bind(r(e)),e.onChangeButtonsLabel=e.onChangeButtonsLabel.bind(r(e)),e.onChangeAlignment=e.onChangeAlignment.bind(r(e)),e.getBookMedia=e.getBookMedia.bind(r(e)),e}return function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function\");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(t,m),o(t,null,[{key:\"getInitialState\",value:function(e){return{posts:[],selectedPost:e,post:{}}}}]),o(t,[{key:\"onChangeSelectPost\",value:function(e){var t=this.state.posts.find(function(t){return t.id==parseInt(e)});this.setState({selectedPost:parseInt(e),post:t});var n=t.mbt_book_teaser[0],l=t.excerpt.rendered,a=t.mbt_sample_audio[0],r=t.mbt_unique_id_asin[0],s=t.mbt_book_image_id[0];this.getBookMedia(s);var o=t.mbt_buybuttons[0];this.props.setAttributes({selectedPost:parseInt(e),title:t.title.rendered,link:t.link,buylinks:o,tagline:n,blurb:l,audioSample:a,bookSample:r})}},{key:\"getBookMedia\",value:function(e){var t=this;new wp.media.model.Attachment.get(e).fetch().then(function(e){t.props.setAttributes({cover:e.url})})}},{key:\"onChangeTitlePrefix\",value:function(e){this.props.setAttributes({titlePrefix:e})}},{key:\"onChangeButtonsLabel\",value:function(e){this.props.setAttributes({buttonsLabel:e})}},{key:\"onChangeAlignment\",value:function(e){this.props.setAttributes({alignment:void 0===e?\"none\":e})}},{key:\"getOptions\",value:function(){var e=this;wp.api.models.Post.extend({urlRoot:wpApiSettings.root+\"wp/v2/mbt_book\",defaults:{type:\"mbt_book\"}});(new(wp.api.collections.Posts.extend({url:wpApiSettings.root+\"wp/v2/mbt_book\"}))).fetch().then(function(t){if(t&&0!==e.state.selectedPost){var n=t.find(function(t){return t.id==e.state.selectedPost});e.setState({post:n,posts:t})}else e.setState({posts:t})})}},{key:\"render\",value:function(){var e=[{value:0,label:p(\"Select a Post\")}];p(\"Choose Book\");return this.props.className+=\" loading\",this.state.posts.length>0?this.state.posts.forEach(function(t){e.push({value:t.id,label:t.title.rendered})}):p(\"No posts found. Please create some first.\"),void 0!==this.state.post&&this.state.post.hasOwnProperty(\"title\")?(wp.element.createElement(\"div\",{className:\"post\"},wp.element.createElement(\"a\",{href:this.state.post.link},this.state.post.title.rendered)),this.props.className+=\" has-post\"):this.props.className+=\" no-post\",wp.element.createElement(\"div\",{className:this.props.className},wp.element.createElement(c,{onChange:this.onChangeSelectPost,value:this.props.attributes.selectedPost,label:p(\"Select a Book\"),options:e,className:\"book-select\"}),wp.element.createElement(\"div\",{className:\"block-preview \"},wp.element.createElement(\"h2\",{className:\"preview-title is-flex\"},this.props.attributes.title&&wp.element.createElement(\"label\",{className:\"components-base-control__label block-label\"},\"Title Prefix:    \"),this.props.attributes.title&&wp.element.createElement(f,{tagName:\"h4\",placeholder:\"Coming Soon, etc.\",className:\"title-prefix\",value:this.props.attributes.titlePrefix,onChange:this.onChangeTitlePrefix,keepPlaceholderOnFocus:!0}),wp.element.createElement(\"span\",{className:\"title\"},this.props.attributes.title)),wp.element.createElement(\"div\",{class:\"inner-preview is-flex\"},wp.element.createElement(\"div\",{className:\"preview-left\"},this.props.attributes.cover&&wp.element.createElement(\"img\",{src:this.props.attributes.cover,className:\"preview-cover\"}),wp.element.createElement(\"div\",{className:\"cover-links\"},this.props.attributes.bookSample&&wp.element.createElement(\"span\",null,\"View Book Sample\"),this.props.attributes.bookSample&&this.props.attributes.audioSample&&wp.element.createElement(\"span\",{className:\"divider\"},\" | \"),this.props.attributes.audioSample&&wp.element.createElement(\"span\",null,\"Hear Audiobook Sample\"))),wp.element.createElement(\"div\",{className:\"preview-right\"},wp.element.createElement(\"div\",{className:\"preview-right-top\"},this.props.attributes.tagline&&wp.element.createElement(\"div\",{class:\"preview-tagline\"},this.props.attributes.tagline),this.props.attributes.blurb&&wp.element.createElement(\"div\",{class:\"preview-blurb\"},wp.element.createElement(\"span\",{className:\"blurb-text\",dangerouslySetInnerHTML:{__html:this.props.attributes.blurb}}),wp.element.createElement(\"span\",{className:\"blurb-link\"},wp.element.createElement(\"a\",{className:\"button button-primary\",href:this.props.attributes.link},\"Read More\")))),wp.element.createElement(\"div\",{className:\"buylinks\"},this.props.attributes.buylinks&&this.props.attributes.buttonsLabel&&wp.element.createElement(f,{tagName:\"h4\",placeholder:\"Now Available From\",className:\"buttons-label\",value:this.props.attributes.buttonsLabel,onChange:this.onChangeButtonsLabel,keepPlaceholderOnFocus:!0}),this.props.attributes.buylinks&&wp.element.createElement(\"ul\",null,this.props.attributes.buylinks.map(function(e,t){return wp.element.createElement(\"li\",{className:e.store},wp.element.createElement(\"a\",{href:e.url},e.store))})))))))}}]),t}());u(\"blueprint-blocks/mbt-book\",{title:p(\"MBT Book Custom Display\"),icon:\"book\",category:\"common\",keywords:[p(\"blueprint-blocks — mbt-book\"),p(\"Book\")],attributes:{title:{type:\"string\"},link:{type:\"string\",selector:\"a\"},selectedPost:{type:\"number\",default:null},buylinks:{type:\"array\"},cover:{type:\"string\"},tagline:{type:\"string\"},blurb:{type:\"string\"},audioSample:{type:\"string\",default:\"\"},bookSample:{type:\"string\",default:\"\"},titlePrefix:{type:\"string\",source:\"html\",selector:\".title-prefix\"},buttonsLabel:{type:\"string\",source:\"html\",selector:\".buttons-label\",default:\"Now Available From\"},customLabel:{type:\"boolean\",selector:\".custom-label\"},alignment:{type:\"string\",default:\"none\"}},edit:d,save:function(e){return wp.element.createElement(\"div\",{className:e.className},wp.element.createElement(\"div\",{className:\"inner is-flex\"},wp.element.createElement(\"div\",{className:\"preview-left\"},e.attributes.cover&&wp.element.createElement(\"a\",{href:e.attributes.link,className:\"image-link\"},wp.element.createElement(\"img\",{src:e.attributes.cover,className:\"preview-cover\",alt:e.attributes.title})),wp.element.createElement(\"div\",{className:\"cover-links\"},e.attributes.bookSample&&wp.element.createElement(\"a\",{className:\"preview-link book-sample\",href:\"https://read.amazon.com/kp/embed?asin=\"+e.attributes.bookSample+\"&preview=newtab\"},\"View Book Sample\"),e.attributes.bookSample&&e.attributes.audioSample&&wp.element.createElement(\"span\",{className:\"divider\"},\" | \"),e.attributes.audioSample&&wp.element.createElement(\"a\",{className:\"preview-link audio-sample\",href:e.attributes.audioSample,target:\"_blank\",rel:\"noopener noreferrer\"},\"Hear Audiobook Sample\"))),wp.element.createElement(\"div\",{className:\"preview-right\"},wp.element.createElement(\"div\",{className:\"preview-right-top\"},wp.element.createElement(\"h2\",{className:\"preview-title\"},e.attributes.titlePrefix&&wp.element.createElement(f.Content,{tagName:\"span\",className:\"title-prefix\",value:e.attributes.titlePrefix}),e.attributes.title),e.attributes.tagline&&wp.element.createElement(\"div\",{class:\"preview-tagline\"},e.attributes.tagline),e.attributes.blurb&&wp.element.createElement(\"div\",{class:\"preview-blurb\"},wp.element.createElement(\"span\",{className:\"blurb-text\",dangerouslySetInnerHTML:{__html:e.attributes.blurb}}),wp.element.createElement(\"span\",{className:\"blurb-link\"},wp.element.createElement(\"a\",{className:\"button button-primary button-inline\",href:e.attributes.link},\"Read More\")))),wp.element.createElement(\"div\",{className:\"buylinks\"},e.attributes.buylinks&&e.attributes.buttonsLabel&&wp.element.createElement(f.Content,{tagName:\"h6\",className:\"buttons-label\",value:e.attributes.buttonsLabel}),e.attributes.buylinks&&wp.element.createElement(\"ul\",null,e.attributes.buylinks.map(function(e,t){return wp.element.createElement(\"li\",{className:e.store},wp.element.createElement(\"a\",{href:e.url},e.store))}))))))}})},function(e,t){},,function(e,t){}]);","extractedComments":[]}