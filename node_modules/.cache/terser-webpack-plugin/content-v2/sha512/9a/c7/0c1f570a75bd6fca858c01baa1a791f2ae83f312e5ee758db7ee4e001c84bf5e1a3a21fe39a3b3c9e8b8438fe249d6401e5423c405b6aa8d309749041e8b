{"code":"!function(e){var t={};function n(s){if(t[s])return t[s].exports;var l=t[s]={i:s,l:!1,exports:{}};return e[s].call(l.exports,l,l.exports,n),l.l=!0,l.exports}n.m=e,n.c=t,n.d=function(e,t,s){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},n.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&\"object\"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,\"default\",{enumerable:!0,value:e}),2&t&&\"string\"!=typeof e)for(var l in e)n.d(s,l,function(t){return e[t]}.bind(null,l));return s},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,\"a\",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p=\"\",n(n.s=0)}([function(e,t,n){\"use strict\";n.r(t);n(1),n(3);function s(e){return(s=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&\"function\"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":typeof e})(e)}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function a(e){if(void 0===e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return e}function o(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,\"value\"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function r(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var p=wp.i18n.__,u=wp.blocks.registerBlockType,c=wp.components,m=c.SelectControl,b=c.ToggleControl,f=wp.element.Component,h=wp.editor,d=h.RichText,w=(h.BlockControls,function(e){function t(){var e,n,o;return function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,t),n=this,(e=!(o=l(t).apply(this,arguments))||\"object\"!==s(o)&&\"function\"!=typeof o?a(n):o).state=e.constructor.getInitialState(e.props.attributes.selectedPost),e.getOptions=e.getOptions.bind(a(e)),e.getOptions(),e.onChangeSelectPost=e.onChangeSelectPost.bind(a(e)),e.onChangeTitlePrefix=e.onChangeTitlePrefix.bind(a(e)),e.onChangeButtonsLabel=e.onChangeButtonsLabel.bind(a(e)),e.onChangeFlexDirection=e.onChangeFlexDirection.bind(a(e)),e.onChangeCustomLabel=e.onChangeCustomLabel.bind(a(e)),e.onChangeCustomButton=e.onChangeCustomButton.bind(a(e)),e.getBookMedia=e.getBookMedia.bind(a(e)),e}return function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function\");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(t,f),r(t,null,[{key:\"getInitialState\",value:function(e){return{posts:[],selectedPost:e,post:{}}}}]),r(t,[{key:\"onChangeSelectPost\",value:function(e){var t=this.state.posts.find(function(t){return t.id==parseInt(e)});this.setState({selectedPost:parseInt(e),post:t});var n=t.mbt_book_teaser[0],s=t.excerpt.rendered,l=t.mbt_sample_audio[0],a=t.mbt_unique_id_asin[0],o=t.mbt_book_image_id[0];this.getBookMedia(o);var r=t.mbt_buybuttons[0];this.props.setAttributes({selectedPost:parseInt(e),title:t.title.rendered,link:t.link,buylinks:r,tagline:n,blurb:s,audioSample:l,bookSample:a,customLabel:!1,buttonsLabel:\"Now Available From\",titlePrefix:\"\"})}},{key:\"getBookMedia\",value:function(e){var t=this;new wp.media.model.Attachment.get(e).fetch().then(function(e){t.props.setAttributes({cover:e.url})})}},{key:\"onChangeTitlePrefix\",value:function(e){this.props.setAttributes({titlePrefix:e})}},{key:\"onChangeButtonsLabel\",value:function(e){this.props.setAttributes({buttonsLabel:e})}},{key:\"onChangeFlexDirection\",value:function(){this.props.attributes.flexReverse?this.props.setAttributes({flexReverse:!1,flexClass:\"flex-row\"}):this.props.setAttributes({flexReverse:!0,flexClass:\"flex-row-reverse\"})}},{key:\"onChangeCustomLabel\",value:function(){this.props.attributes.customLabel?this.props.setAttributes({customLabel:!1}):this.props.setAttributes({customLabel:!0})}},{key:\"onChangeCustomButton\",value:function(){this.props.attributes.customButton?this.props.setAttributes({customButton:!1}):this.props.setAttributes({customButton:!0})}},{key:\"getOptions\",value:function(){var e=this;wp.api.models.Post.extend({urlRoot:wpApiSettings.root+\"wp/v2/mbt_book\",defaults:{type:\"mbt_book\"}});(new(wp.api.collections.Posts.extend({url:wpApiSettings.root+\"wp/v2/mbt_book\"}))).fetch().then(function(t){if(t&&0!==e.state.selectedPost){var n=t.find(function(t){return t.id==e.state.selectedPost});e.setState({post:n,posts:t})}else e.setState({posts:t})})}},{key:\"render\",value:function(){var e=[{value:0,label:p(\"Select a Post\")}];p(\"Choose Book\");return this.props.className+=\" loading\",this.state.posts.length>0?this.state.posts.forEach(function(t){e.push({value:t.id,label:t.title.rendered})}):p(\"No posts found. Please create some first.\"),void 0!==this.state.post&&this.state.post.hasOwnProperty(\"title\")?(wp.element.createElement(\"div\",{className:\"post\"},wp.element.createElement(\"a\",{href:this.state.post.link},this.state.post.title.rendered)),this.props.className+=\" has-post\"):this.props.className+=\" no-post\",wp.element.createElement(\"div\",{className:this.props.className},wp.element.createElement(\"div\",{className:\"block-directions\"},\"Select book to display. Editable text fields are highlighted in blue, below.\"),wp.element.createElement(m,{onChange:this.onChangeSelectPost,value:this.props.attributes.selectedPost,label:p(\"Select a Book\"),options:e,className:\"book-select\"}),wp.element.createElement(b,{label:\"Reverse Cover Position\",checked:!!this.props.attributes.flexReverse,onChange:this.onChangeFlexDirection,className:\"flex-direction\"}),wp.element.createElement(\"div\",{className:\"block-preview \"},wp.element.createElement(\"h2\",{className:\"preview-title is-flex\"},wp.element.createElement(\"div\",null,this.props.attributes.title&&wp.element.createElement(\"label\",{className:\"components-base-control__label block-label\"},\"Title Prefix:    \"),this.props.attributes.title&&wp.element.createElement(d,{tagName:\"h4\",placeholder:\"Coming Soon, etc.\",className:\"title-prefix\",value:this.props.attributes.titlePrefix,onChange:this.onChangeTitlePrefix,keepPlaceholderOnFocus:!0,withoutInteractiveFormatting:!0})),wp.element.createElement(\"span\",{className:\"title\"},this.props.attributes.title)),wp.element.createElement(\"div\",{className:\"inner-preview is-flex \"+this.props.attributes.flexClass},wp.element.createElement(\"div\",{className:\"preview-left\"},this.props.attributes.cover&&wp.element.createElement(\"img\",{src:this.props.attributes.cover,className:\"preview-cover\"}),wp.element.createElement(\"div\",{className:\"cover-links\"},this.props.attributes.bookSample&&wp.element.createElement(\"span\",null,\"View Book Sample\"),this.props.attributes.bookSample&&this.props.attributes.audioSample&&wp.element.createElement(\"span\",{className:\"divider\"},\" | \"),this.props.attributes.audioSample&&wp.element.createElement(\"span\",null,\"Hear Audiobook Sample\"))),wp.element.createElement(\"div\",{className:\"preview-right\"},wp.element.createElement(\"div\",{className:\"preview-right-top\"},this.props.attributes.tagline&&wp.element.createElement(\"div\",{class:\"preview-tagline\"},this.props.attributes.tagline),this.props.attributes.blurb&&wp.element.createElement(\"div\",{class:\"preview-blurb\"},wp.element.createElement(\"span\",{className:\"blurb-text\",dangerouslySetInnerHTML:{__html:this.props.attributes.blurb}}),wp.element.createElement(\"span\",{className:\"blurb-link\"},wp.element.createElement(\"a\",{className:\"button button-primary\",href:this.props.attributes.link},\"Read More\")))),wp.element.createElement(\"div\",null,wp.element.createElement(b,{label:\"Custom Button\",checked:!!this.props.attributes.customButton,onChange:this.onChangeCustomButton,className:\"custom-button\"}),wp.element.createElement(b,{label:\"Custom Label for Buttons Section\",checked:!!this.props.attributes.customLabel,onChange:this.onChangeCustomLabel,className:\"custom-label\"}),wp.element.createElement(\"div\",{className:\"buylinks\"},this.props.attributes.buylinks&&this.props.attributes.customLabel?wp.element.createElement(d,{tagName:\"h4\",placeholder:\"Now Available From\",className:\"buttons-label\",value:this.props.attributes.buttonsLabel,onChange:this.onChangeButtonsLabel,keepPlaceholderOnFocus:!0}):wp.element.createElement(d.Content,{tagName:\"h4\",className:\"buttons-label noneditable\",value:this.props.attributes.buttonsLabel}),this.props.attributes.buylinks&&wp.element.createElement(\"ul\",null,this.props.attributes.buylinks.map(function(e,t){return wp.element.createElement(\"li\",{className:e.store},wp.element.createElement(\"a\",{href:e.url},e.store))}))))))))}}]),t}());u(\"blueprint-blocks/mbt-book\",{title:p(\"Book Preview\"),icon:\"book\",category:\"common\",keywords:[p(\"blueprint-blocks — mbt-book\"),p(\"Book\")],attributes:{title:{type:\"string\"},link:{type:\"string\",selector:\"a\"},selectedPost:{type:\"number\",default:null},buylinks:{type:\"array\"},cover:{type:\"string\"},tagline:{type:\"string\"},blurb:{type:\"string\"},audioSample:{type:\"string\",default:\"\"},bookSample:{type:\"string\",default:\"\"},titlePrefix:{type:\"string\",source:\"html\",selector:\".title-prefix\"},buttonsLabel:{type:\"string\",source:\"html\",selector:\".buttons-label\",default:\"Now Available From\"},customLabel:{type:\"boolean\",default:!1},flexReverse:{type:\"boolean\",default:!1},customButton:{type:\"boolean\",default:!1},flexClass:{type:\"string\",default:\"flex-row\"}},edit:w,save:function(e){return wp.element.createElement(\"div\",{className:e.className},wp.element.createElement(\"div\",{className:\"inner is-flex \"+e.attributes.flexClass},wp.element.createElement(\"div\",{className:\"preview-left\"},e.attributes.cover&&wp.element.createElement(\"a\",{href:e.attributes.link,className:\"image-link\"},wp.element.createElement(\"img\",{src:e.attributes.cover,className:\"preview-cover\",alt:e.attributes.title})),wp.element.createElement(\"div\",{className:\"cover-links\"},e.attributes.bookSample&&wp.element.createElement(\"a\",{className:\"preview-link book-sample\",href:\"https://read.amazon.com/kp/embed?asin=\"+e.attributes.bookSample+\"&preview=newtab\"},\"View Book Sample\"),e.attributes.bookSample&&e.attributes.audioSample&&wp.element.createElement(\"span\",{className:\"divider\"},\" | \"),e.attributes.audioSample&&wp.element.createElement(\"a\",{className:\"preview-link audio-sample\",href:e.attributes.audioSample,target:\"_blank\",rel:\"noopener noreferrer\"},\"Hear Audiobook Sample\"))),wp.element.createElement(\"div\",{className:\"preview-right\"},wp.element.createElement(\"div\",{className:\"preview-right-top\"},wp.element.createElement(\"h2\",{className:\"preview-title\"},e.attributes.titlePrefix&&wp.element.createElement(d.Content,{tagName:\"span\",className:\"title-prefix\",value:e.attributes.titlePrefix}),e.attributes.title),e.attributes.tagline&&wp.element.createElement(\"div\",{class:\"preview-tagline\"},e.attributes.tagline),e.attributes.blurb&&wp.element.createElement(\"div\",{class:\"preview-blurb\"},wp.element.createElement(\"span\",{className:\"blurb-text\",dangerouslySetInnerHTML:{__html:e.attributes.blurb}}),wp.element.createElement(\"span\",{className:\"blurb-link\"},wp.element.createElement(\"a\",{className:\"button button-primary button-inline\",href:e.attributes.link},\"Read More\")))),wp.element.createElement(\"div\",{className:\"buylinks\"},e.attributes.buylinks&&e.attributes.buttonsLabel&&wp.element.createElement(d.Content,{tagName:\"h6\",className:\"buttons-label\",value:e.attributes.buttonsLabel}),e.attributes.buylinks&&wp.element.createElement(\"ul\",null,e.attributes.buylinks.map(function(e,t){return wp.element.createElement(\"li\",{className:e.store},wp.element.createElement(\"a\",{href:e.url},e.store))}))))))}})},function(e,t){},,function(e,t){}]);","extractedComments":[]}